// =============================================================================
// presentation/src/handlers/healthz.rs: ヘルスチェックハンドラ
// =============================================================================
// Kubernetes や ロードバランサーのヘルスチェック用エンドポイント。
// サーバーが正常に稼働しているかを確認するためのシンプルなハンドラ。
//
// 用途:
// - Kubernetes の liveness probe: Pod が生きているか確認
// - Kubernetes の readiness probe: トラフィックを受け入れ可能か確認
// - ロードバランサーのヘルスチェック: インスタンスが正常か確認
//
// エンドポイント:
// GET /health → 200 OK {"status": "ok"}
// =============================================================================

// -----------------------------------------------------------------------------
// 外部クレートのインポート
// -----------------------------------------------------------------------------

// axum: Web フレームワーク
// StatusCode: HTTP ステータスコード（200, 404 など）
// IntoResponse: 任意の型を HTTP レスポンスに変換するトレイト
// Json: JSON レスポンスを構築するヘルパー
use axum::{http::StatusCode, response::IntoResponse, Json};

// =============================================================================
// healthz ハンドラ
// =============================================================================

/// ヘルスチェックエンドポイント
///
/// GET /health
/// サーバーが稼働中かどうかを確認する。
///
/// # Returns
///
/// `impl IntoResponse` - HTTP レスポンス（200 OK + JSON）
///
/// # Response Format
///
/// ```json
/// {"status": "ok"}
/// ```
///
/// # Note
///
/// このエンドポイントは認証不要。
/// DB 接続やキャッシュ接続のチェックは行わない（シンプルな liveness check）。
/// より詳細なヘルスチェックが必要な場合は、/ready エンドポイントを追加検討。
pub async fn healthz() -> impl IntoResponse {
    // タプル (StatusCode, Json<Value>) を返す
    // axum は IntoResponse を実装しているため、自動的に HTTP レスポンスに変換される
    // serde_json::json! マクロで JSON オブジェクトを構築
    (StatusCode::OK, Json(serde_json::json!({"status": "ok"})))
}
